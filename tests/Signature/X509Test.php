<?php

namespace XML\Tests\Signature;

use XML\Tests\Cert;
use XML\Tests\TestCase;
use XML\Signature\X509;

class X509Test extends TestCase
{
    public function testShouldHandleP12Certificate()
    {
        $certs = X509::fromFile(Cert::file('persona_juridica_pruebas_vigente.p12'), 'persona_juridica_pruebas');
        $this->assertEquals($certs->getValue(), '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');

        $this->assertCount(3, $certs->all());
    }
}
